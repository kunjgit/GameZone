!function(e,t,n){function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function o(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return d[e.which]?d[e.which]:k[e.which]?k[e.which]:String.fromCharCode(e.which).toLowerCase()}function a(e){e=e||{};var t,n=!1;for(t in C)e[t]?n=!0:C[t]=0;n||(q=!1)}function i(e,t,n,r,o,a){var i,s,c=[],u=n.type;if(!w[e])return[];for("keyup"==u&&f(e)&&(t=[e]),i=0;i<w[e].length;++i)if(s=w[e][i],!(!r&&s.seq&&C[s.seq]!=s.level||u!=s.action||("keypress"!=u||n.metaKey||n.ctrlKey)&&t.sort().join(",")!==s.modifiers.sort().join(","))){var l=r&&s.seq==r&&s.level==a;(!r&&s.combo==o||l)&&w[e].splice(i,1),c.push(s)}return c}function s(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function c(e,t,n,r){P.stopCallback(t,t.target||t.srcElement,n,r)||!1!==e(t,n)||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}function u(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=o(e);t&&("keyup"==e.type&&E===t?E=!1:P.handleKey(t,s(e),e))}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function l(e,t,n,r){function i(t){return function(){q=t,++C[e],clearTimeout(m),m=setTimeout(a,1e3)}}function s(t){c(n,t,e),"keyup"!==r&&(E=o(t)),setTimeout(a,10)}for(var u=C[e]=0;u<t.length;++u){var f=u+1===t.length?s:i(r||h(t[u+1]).action);p(t[u],f,r,e,u)}}function h(e,t){var n,r,o,a=[];for(n="+"===e?["+"]:e.split("+"),o=0;o<n.length;++o)r=n[o],g[r]&&(r=g[r]),t&&"keypress"!=t&&v[r]&&(r=v[r],a.push("shift")),f(r)&&a.push(r);if(n=r,o=t,!o){if(!y){y={};for(var i in d)i>95&&112>i||d.hasOwnProperty(i)&&(y[d[i]]=i)}o=y[n]?"keydown":"keypress"}return"keypress"==o&&a.length&&(o="keydown"),{key:r,modifiers:a,action:o}}function p(e,t,n,r,o){b[e+":"+n]=t,e=e.replace(/\s+/g," ");var a=e.split(" ");1<a.length?l(e,a,t,n):(n=h(e,n),w[n.key]=w[n.key]||[],i(n.key,n.modifiers,{type:n.action},r,e,o),w[n.key][r?"unshift":"push"]({callback:t,modifiers:n.modifiers,action:n.action,seq:r,level:o,combo:e}))}var y,m,d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},v={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},g={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},w={},b={},C={},E=!1,K=!1,q=!1;for(n=1;20>n;++n)d[111+n]="f"+n;for(n=0;9>=n;++n)d[n+96]=n;r(t,"keypress",u),r(t,"keydown",u),r(t,"keyup",u);var P={bind:function(e,t,n){e=e instanceof Array?e:[e];for(var r=0;r<e.length;++r)p(e[r],t,n);return this},unbind:function(e,t){return P.bind(e,function(){},t)},trigger:function(e,t){return b[e+":"+t]&&b[e+":"+t]({},e),this},reset:function(){return w={},b={},this},stopCallback:function(e,t){return-1<(" "+t.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},handleKey:function(e,t,n){var r,o=i(e,t,n);t={};var s=0,u=!1;for(r=0;r<o.length;++r)o[r].seq&&(s=Math.max(s,o[r].level));for(r=0;r<o.length;++r)o[r].seq?o[r].level==s&&(u=!0,t[o[r].seq]=1,c(o[r].callback,n,o[r].combo,o[r].seq)):u||c(o[r].callback,n,o[r].combo);o="keypress"==n.type&&K,n.type!=q||f(e)||o||a(t),K=u&&"keydown"==n.type}};e.Mousetrap=P,"function"==typeof define&&define.amd&&define(P)}(window,document);